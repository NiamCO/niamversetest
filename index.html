<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NiamVerse - Ultimate Gaming Experience</title>
    <link rel="icon" type="image/x-icon" href="favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.png">
    <link rel="apple-touch-icon" href="favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7;
            --primary-dark: #5649c0;
            --secondary: #fd79a8;
            --accent: #00cec9;
            --dark: #2d3436;
            --light: #f5f6fa;
            --gray: #636e72;
            --success: #00b894;
            --warning: #fdcb6e;
            --danger: #e17055;
            --card-bg: rgba(255, 255, 255, 0.9);
            --header-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        .dark-theme {
            --primary: #a29bfe;
            --primary-dark: #8179d4;
            --secondary: #ff9fb4;
            --accent: #81ecec;
            --dark: #dfe6e9;
            --light: #2d3436;
            --gray: #b2bec3;
            --card-bg: rgba(45, 52, 54, 0.9);
            --header-bg: rgba(45, 52, 54, 0.95);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            min-height: 100vh;
            transition: var(--transition);
            padding-bottom: 80px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background: var(--header-bg);
            backdrop-filter: blur(10px);
            border-radius: 0 0 20px 20px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            transition: var(--transition);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            object-fit: contain;
        }

        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .search-bar {
            flex: 1;
            max-width: 500px;
            margin: 0 30px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 20px;
            border-radius: 50px;
            border: 2px solid var(--primary);
            background: var(--light);
            color: var(--dark);
            font-size: 16px;
            transition: var(--transition);
        }

        .search-bar input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.3);
        }

        .search-bar i {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            padding: 10px 20px;
            border-radius: 50px;
            background: var(--primary);
            color: white;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: var(--secondary);
            box-shadow: 0 5px 15px rgba(253, 121, 168, 0.4);
        }

        /* Main Content */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        .page-title {
            font-size: 32px;
            margin-bottom: 20px;
            text-align: center;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .game-card {
            background: var(--card-bg);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }

        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .game-card.featured::before {
            content: "FEATURED";
            position: absolute;
            top: 15px;
            right: -30px;
            background: var(--secondary);
            color: white;
            padding: 5px 30px;
            font-size: 12px;
            font-weight: bold;
            transform: rotate(45deg);
            z-index: 2;
        }

        .game-thumb {
            width: 100%;
            height: 180px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary), var(--accent));
        }

        .game-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .game-card:hover .game-image {
            transform: scale(1.05);
        }

        .fallback-icon {
            font-size: 50px;
            color: white;
            opacity: 0.7;
            position: absolute;
        }

        .game-info {
            padding: 15px;
        }

        .game-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .game-about {
            font-size: 14px;
            color: var(--gray);
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Game Frame */
        .game-frame-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            display: none;
            flex-direction: column;
            animation: fadeIn 0.3s ease;
        }

        .game-frame-container.active {
            display: flex;
        }

        .game-frame-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
        }

        .game-frame-title {
            font-size: 20px;
            font-weight: 600;
        }

        .game-frame-controls {
            display: flex;
            gap: 15px;
        }

        .frame-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: var(--transition);
        }

        .frame-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .game-frame {
            flex: 1;
            border: none;
            background: white;
        }

        /* Settings */
        .settings-container {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--shadow);
            max-width: 800px;
            margin: 0 auto;
        }

        .setting-section {
            margin-bottom: 30px;
        }

        .setting-title {
            font-size: 22px;
            margin-bottom: 15px;
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 8px;
        }

        .theme-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .theme-option {
            flex: 1;
            min-width: 150px;
            padding: 15px;
            border-radius: 12px;
            background: var(--light);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .theme-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .theme-option.active {
            border-color: var(--primary);
        }

        .theme-preview {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            margin: 0 auto 10px;
        }

        .light-preview {
            background: linear-gradient(135deg, #6c5ce7, #fd79a8);
        }

        .dark-preview {
            background: linear-gradient(135deg, #2d3436, #636e72);
        }

        .cloaking-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .cloaking-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--light);
            border-radius: 12px;
            transition: var(--transition);
            cursor: pointer;
        }

        .cloaking-option:hover {
            background: rgba(108, 92, 231, 0.1);
        }

        .cloak-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .cloak-1 {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
        }

        .cloak-2 {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
        }

        .cloak-3 {
            background: linear-gradient(135deg, #55efc4, #00b894);
        }

        .custom-cloaking {
            margin-top: 20px;
            padding: 20px;
            background: var(--light);
            border-radius: 12px;
        }

        .custom-cloaking h3 {
            margin-bottom: 15px;
            color: var(--primary);
        }

        .cloaking-inputs {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            font-weight: 500;
            color: var(--dark);
        }

        .input-group input {
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid var(--primary);
            background: var(--card-bg);
            color: var(--dark);
            transition: var(--transition);
        }

        .input-group input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.3);
        }

        .cloak-btn {
            padding: 12px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .cloak-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .about-blank-embedder {
            background: var(--light);
            padding: 20px;
            border-radius: 12px;
        }

        .embedder-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .embedder-input input {
            flex: 1;
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid var(--primary);
            background: var(--card-bg);
            color: var(--dark);
        }

        .embed-btn {
            padding: 12px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .embed-btn:hover {
            background: var(--primary-dark);
        }

        /* Footer */
        footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--header-bg);
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .social-link {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
        }

        .social-link:hover {
            color: var(--primary);
            transform: translateY(-2px);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 992px) {
            .header-content {
                flex-wrap: wrap;
            }
            
            .search-bar {
                order: 3;
                max-width: 100%;
                margin: 15px 0 0;
            }
            
            .nav-buttons {
                overflow-x: auto;
                padding-bottom: 10px;
            }
        }

        @media (max-width: 768px) {
            .games-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
            
            .theme-options {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header with Navigation -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <img src="icon.png" alt="NiamVerse Logo" class="logo">
                    <div class="logo-text">NiamVerse</div>
                </div>
                
                <div class="search-bar">
                    <input type="text" placeholder="Search for games...">
                    <i class="fas fa-search"></i>
                </div>
                
                <div class="nav-buttons">
                    <button class="nav-btn active" data-page="home">
                        <i class="fas fa-home"></i> Home
                    </button>
                    <button class="nav-btn" data-page="new">
                        <i class="fas fa-star"></i> New
                    </button>
                    <button class="nav-btn" data-page="trending">
                        <i class="fas fa-fire"></i> Trending
                    </button>
                    <button class="nav-btn" data-page="favorites">
                        <i class="fas fa-heart"></i> Favorites
                    </button>
                    <button class="nav-btn" data-page="recent">
                        <i class="fas fa-history"></i> Recent
                    </button>
                    <button class="nav-btn" data-page="settings">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Home Page -->
        <section id="home" class="page active">
            <h1 class="page-title">All Games</h1>
            <div class="games-grid" id="home-games">
                <!-- Games will be loaded here by JavaScript -->
            </div>
        </section>

        <!-- New Games Page -->
        <section id="new" class="page">
            <h1 class="page-title">New Games</h1>
            <div class="games-grid" id="new-games">
                <!-- New games will be loaded here by JavaScript -->
            </div>
        </section>

        <!-- Trending Games Page -->
        <section id="trending" class="page">
            <h1 class="page-title">Trending Games</h1>
            <div class="games-grid" id="trending-games">
                <!-- Trending games will be loaded here by JavaScript -->
            </div>
        </section>

        <!-- Favorites Page -->
        <section id="favorites" class="page">
            <h1 class="page-title">Your Favorites</h1>
            <div class="games-grid" id="favorites-games">
                <!-- Favorite games will be loaded here by JavaScript -->
            </div>
        </section>

        <!-- Recent Games Page -->
        <section id="recent" class="page">
            <h1 class="page-title">Recently Played</h1>
            <div class="games-grid" id="recent-games">
                <!-- Recent games will be loaded here by JavaScript -->
            </div>
        </section>

        <!-- Settings Page -->
        <section id="settings" class="page">
            <h1 class="page-title">Settings</h1>
            <div class="settings-container">
                <div class="setting-section">
                    <h2 class="setting-title">Themes</h2>
                    <div class="theme-options">
                        <div class="theme-option active" data-theme="light">
                            <div class="theme-preview light-preview"></div>
                            <div>Light Theme</div>
                        </div>
                        <div class="theme-option" data-theme="dark">
                            <div class="theme-preview dark-preview"></div>
                            <div>Dark Theme</div>
                        </div>
                    </div>
                </div>

                <div class="setting-section">
                    <h2 class="setting-title">Tab Cloaking</h2>
                    <div class="cloaking-options">
                        <div class="cloaking-option" data-cloak="study">
                            <div class="cloak-icon cloak-1">
                                <i class="fas fa-book"></i>
                            </div>
                            <div>
                                <h3>Study Mode</h3>
                                <p>Changes tab title to "Google Classroom"</p>
                            </div>
                        </div>
                        <div class="cloaking-option" data-cloak="work">
                            <div class="cloak-icon cloak-2">
                                <i class="fas fa-briefcase"></i>
                            </div>
                            <div>
                                <h3>Work Mode</h3>
                                <p>Changes tab title to "Google Docs"</p>
                            </div>
                        </div>
                        <div class="cloaking-option" data-cloak="research">
                            <div class="cloak-icon cloak-3">
                                <i class="fas fa-search"></i>
                            </div>
                            <div>
                                <h3>Research Mode</h3>
                                <p>Changes tab title to "Google Search"</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="custom-cloaking">
                        <h3>Custom Tab Cloaking</h3>
                        <div class="cloaking-inputs">
                            <div class="input-group">
                                <label for="custom-title">Tab Title:</label>
                                <input type="text" id="custom-title" placeholder="Enter custom tab title">
                            </div>
                            <div class="input-group">
                                <label for="custom-favicon">Favicon URL:</label>
                                <input type="text" id="custom-favicon" placeholder="Enter favicon image URL">
                            </div>
                            <button class="cloak-btn" id="apply-custom-cloak">Apply Custom Cloak</button>
                        </div>
                    </div>
                </div>

                <div class="setting-section">
                    <h2 class="setting-title">About:Blank Embedder</h2>
                    <div class="about-blank-embedder">
                        <p>Embed any website in an about:blank page for maximum privacy (If you want this page embedded, type "https://niamco.github.io/niamverse/" and click embed).</p>
                        <div class="embedder-input">
                            <input type="text" id="embed-url" placeholder="Enter website URL">
                            <button class="embed-btn" id="embed-button">Embed</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Game Frame (Hidden by default) -->
    <div class="game-frame-container" id="game-frame">
        <div class="game-frame-header">
            <div class="game-frame-title" id="frame-title">Game Title</div>
            <div class="game-frame-controls">
                <button class="frame-btn" id="fullscreen-btn">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="frame-btn" id="share-btn">
                    <i class="fas fa-share-alt"></i>
                </button>
                <button class="frame-btn" id="favorite-btn">
                    <i class="far fa-heart"></i>
                </button>
                <button class="frame-btn" id="close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <iframe class="game-frame" id="game-iframe" src=""></iframe>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="social-links">
                <a href="https://www.youtube.com/@NiamCo-1" class="social-link" target="_blank">
                    <i class="fab fa-youtube"></i> YouTube
                </a>
                <a href="https://github.com/NiamCO" class="social-link" target="_blank">
                    <i class="fab fa-github"></i> GitHub
                </a>
                <a href="#" class="social-link">
                    <i class="fab fa-discord"></i> Discord
                </a>
                <a href="#" class="social-link">
                    <i class="fab fa-twitter"></i> Twitter
                </a>
            </div>
        </div>
    </footer>

    <script>
        // Sample games data - you can replace this with your full JSON data
        const games = [
            {
                id: 2,
                name: "1v1.LOL",
                category: "action",
                popularity: "80M+",
                featured: true,
                link: "https://macvg-games.github.io/action-games/1v1lol/",
                about: "1v1.LOL is a fun battle royale and survival shooting game where your only goal is to survive. Use the controls smart and well to attack or defense by shooting weapons or building stuff from your materials!",
                thumb: "https://macvg-games.github.io/action-games/1v1lol/splash.png",
                new: false,
                trending: 85000
            },
            {
                id: 4,
                name: "10 Minutes Till Dawn",
                category: "action",
                popularity: "10M+",
                featured: false,
                link: "https://macvg-games.github.io/action-games/10-minutes-till-dawn/",
                about: "10 Minutes Till Dawn is a very exciting fantasy survival game for you to play! Use WASD to move and dodge the creatures or else you'll loose hearts and die.",
                thumb: "https://macvg-games.github.io/action-games/10-minutes-till-dawn/splash.png",
                new: true,
                trending: 45000
            },
            {
                id: 234,
                name: "Subway Surfers",
                category: "action",
                popularity: "1B+",
                featured: true,
                link: "https://macvg-games.github.io/action-games/subway-surfers/",
                about: "Subway Surfers, a fun and addicting endless parkour game, is one of the most iconic and well-known mobile games in the world! Your mission is to escape from the police, collect coins, while dodging the obstacles!",
                thumb: "https://macvg-games.github.io/action-games/subway-surfers/img/splash.jpg",
                new: false,
                trending: 120000
            },
            {
                id: 53,
                name: "Cookie Clicker",
                category: "casual",
                popularity: "100M+",
                featured: true,
                link: "https://macvg-games.github.io/casual-games/cookie-clicker/",
                about: "Cookie Clicker is the ultimate idle clicker game where you bake cookies, buy upgrades, and expand your cookie empire!",
                thumb: "https://macvg-games.github.io/casual-games/cookie-clicker/cookie1.jpeg",
                new: false,
                trending: 78000
            },
            {
                id: 452,
                name: "Retro Bowl College",
                category: "driving",
                popularity: "30M+",
                featured: true,
                link: "https://macvg-games.github.io/driving-games/retro-bowl-college/",
                about: "Experience college football like never before in this retro-style football management game. Build your team, win championships, and become a legend!",
                thumb: "https://macvg-games.github.io/driving-games/retro-bowl-college/unnamed.png",
                new: true,
                trending: 95000
            },
            {
                id: 30,
                name: "BitLife",
                category: "strategy",
                popularity: "100M+",
                featured: true,
                link: "https://macvg-games.github.io/strategy-games/bitlife/",
                about: "In BitLife, this exciting life simulation game, you can literally be anyone. Write your own life story from birth to death however you like by choosing different options.",
                thumb: "https://macvg-games.github.io/strategy-games/bitlife/splash.png",
                new: false,
                trending: 110000
            },
            {
                id: 205,
                name: "Slope",
                category: "action",
                popularity: "100M+",
                featured: true,
                link: "https://macvg-games.github.io/action-games/slope/",
                about: "In Slope, this exciting fast-paced action game, you need to navigate a ball down an endless slope with breakneck speeds! There are cliffs, curves, blocks, and all sorts of obstacles.",
                thumb: "https://macvg-games.github.io/action-games/slope/slope4.jpeg",
                new: false,
                trending: 65000
            },
            {
                id: 501,
                name: "Ohio Fortnite",
                category: "action",
                popularity: "5M+",
                featured: false,
                link: "https://macvg-games.github.io/action-games/ohio-fortnite/",
                about: "A unique twist on the battle royale genre with wacky Ohio-themed elements. Battle it out in strange environments with unexpected weapons!",
                thumb: "https://macvg-games.github.io/action-games/ohio-fortnite/logo.jpg",
                new: true,
                trending: 32000
            }
        ];

        // DOM Elements
        const navButtons = document.querySelectorAll('.nav-btn');
        const pages = document.querySelectorAll('.page');
        const gamesContainers = {
            home: document.getElementById('home-games'),
            new: document.getElementById('new-games'),
            trending: document.getElementById('trending-games'),
            favorites: document.getElementById('favorites-games'),
            recent: document.getElementById('recent-games')
        };
        const gameFrame = document.getElementById('game-frame');
        const gameIframe = document.getElementById('game-iframe');
        const frameTitle = document.getElementById('frame-title');
        const closeBtn = document.getElementById('close-btn');
        const fullscreenBtn = document.getElementById('fullscreen-btn');
        const shareBtn = document.getElementById('share-btn');
        const favoriteBtn = document.getElementById('favorite-btn');
        const searchInput = document.querySelector('.search-bar input');
        const themeOptions = document.querySelectorAll('.theme-option');
        const cloakingOptions = document.querySelectorAll('.cloaking-option');
        const embedUrlInput = document.getElementById('embed-url');
        const embedButton = document.getElementById('embed-button');
        const customTitleInput = document.getElementById('custom-title');
        const customFaviconInput = document.getElementById('custom-favicon');
        const applyCustomCloakBtn = document.getElementById('apply-custom-cloak');

        // Current state
        let currentGame = null;
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let recentGames = JSON.parse(localStorage.getItem('recentGames')) || [];

        // Initialize the app
        function init() {
            renderGames('home', games);
            renderGames('new', games.filter(game => game.new));
            renderGames('trending', games.sort((a, b) => b.trending - a.trending).slice(0, 12));
            renderFavorites();
            renderRecent();
            
            // Set up event listeners
            setupEventListeners();
            
            // Apply saved theme
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.body.classList.toggle('dark-theme', savedTheme === 'dark');
            
            // Update theme buttons
            themeOptions.forEach(option => {
                option.classList.toggle('active', option.dataset.theme === savedTheme);
            });
        }

        // Set up all event listeners
        function setupEventListeners() {
            // Navigation
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const pageId = button.dataset.page;
                    switchPage(pageId);
                    
                    // Update active button
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                });
            });

            // Game frame controls
            closeBtn.addEventListener('click', closeGameFrame);
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            shareBtn.addEventListener('click', shareGame);
            favoriteBtn.addEventListener('click', toggleFavorite);

            // Search functionality
            searchInput.addEventListener('input', handleSearch);

            // Settings
            themeOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const theme = option.dataset.theme;
                    setTheme(theme);
                    
                    themeOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                });
            });

            cloakingOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const mode = option.dataset.cloak;
                    setTabCloaking(mode);
                });
            });

            embedButton.addEventListener('click', embedWebsite);
            applyCustomCloakBtn.addEventListener('click', applyCustomCloak);
        }

        // Render games to a specific container
        function renderGames(containerId, gamesList) {
            const container = gamesContainers[containerId];
            if (!container) return;

            container.innerHTML = '';
            
            gamesList.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = `game-card ${game.featured ? 'featured' : ''}`;
                gameCard.dataset.id = game.id;
                
                // Use game thumbnail if available, otherwise fallback to icon
                const thumbSrc = game.thumb || 'default-game.png';
                
                gameCard.innerHTML = `
                    <div class="game-thumb">
                        <img src="${thumbSrc}" alt="${game.name}" class="game-image">
                        ${!game.thumb ? `<i class="fas fa-gamepad fallback-icon"></i>` : ''}
                    </div>
                    <div class="game-info">
                        <h3 class="game-title">${game.name}</h3>
                        <p class="game-about">${game.about}</p>
                    </div>
                `;
                
                gameCard.addEventListener('click', () => openGame(game));
                container.appendChild(gameCard);
            });
        }

        // Render favorite games
        function renderFavorites() {
            const favoriteGames = games.filter(game => favorites.includes(game.id));
            renderGames('favorites', favoriteGames);
        }

        // Render recent games
        function renderRecent() {
            const recentGameIds = recentGames.map(game => game.id);
            const recentGamesList = games.filter(game => recentGameIds.includes(game.id));
            renderGames('recent', recentGamesList);
        }

        // Switch between pages
        function switchPage(pageId) {
            pages.forEach(page => {
                page.classList.toggle('active', page.id === pageId);
            });
        }

        // Open a game in the game frame
        function openGame(game) {
            currentGame = game;
            gameIframe.src = game.link;
            frameTitle.textContent = game.name;
            gameFrame.classList.add('active');
            
            // Update favorite button state
            const isFavorite = favorites.includes(game.id);
            favoriteBtn.innerHTML = isFavorite ? '<i class="fas fa-heart"></i>' : '<i class="far fa-heart"></i>';
            
            // Add to recent games
            addToRecent(game);
        }

        // Close the game frame
        function closeGameFrame() {
            gameFrame.classList.remove('active');
            gameIframe.src = '';
            currentGame = null;
        }

        // Toggle fullscreen mode
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                gameFrame.requestFullscreen().catch(err => {
                    console.error(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        }

        // Share game
        function shareGame() {
            if (navigator.share && currentGame) {
                navigator.share({
                    title: currentGame.name,
                    text: `Check out ${currentGame.name} on NiamVerse!`,
                    url: currentGame.link,
                })
                .catch(console.error);
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(currentGame.link).then(() => {
                    alert('Game link copied to clipboard!');
                });
            }
        }

        // Toggle favorite status
        function toggleFavorite() {
            if (!currentGame) return;
            
            const index = favorites.indexOf(currentGame.id);
            if (index > -1) {
                favorites.splice(index, 1);
                favoriteBtn.innerHTML = '<i class="far fa-heart"></i>';
            } else {
                favorites.push(currentGame.id);
                favoriteBtn.innerHTML = '<i class="fas fa-heart"></i>';
            }
            
            localStorage.setItem('favorites', JSON.stringify(favorites));
            renderFavorites();
        }

        // Add game to recent games
        function addToRecent(game) {
            // Remove if already exists
            recentGames = recentGames.filter(item => item.id !== game.id);
            
            // Add to beginning
            recentGames.unshift({
                id: game.id,
                timestamp: Date.now()
            });
            
            // Keep only the 10 most recent
            if (recentGames.length > 10) {
                recentGames = recentGames.slice(0, 10);
            }
            
            localStorage.setItem('recentGames', JSON.stringify(recentGames));
            renderRecent();
        }

        // Handle search
        function handleSearch() {
            const query = searchInput.value.toLowerCase();
            if (query.length < 2) {
                renderGames('home', games);
                return;
            }
            
            const filteredGames = games.filter(game => 
                game.name.toLowerCase().includes(query) || 
                game.about.toLowerCase().includes(query)
            );
            
            renderGames('home', filteredGames);
        }

        // Set theme
        function setTheme(theme) {
            document.body.classList.toggle('dark-theme', theme === 'dark');
            localStorage.setItem('theme', theme);
        }

        // Set tab cloaking
        function setTabCloaking(mode) {
            let title = 'NiamVerse - Ultimate Gaming Experience';
            let favicon = 'favicon.png';
            
            switch(mode) {
                case 'study':
                    title = 'Google Classroom';
                    favicon = 'https://www.gstatic.com/classroom/logo_square_48.svg';
                    break;
                case 'work':
                    title = 'Google Docs';
                    favicon = 'https://www.gstatic.com/images/branding/product/2x/docs_2020q4_48dp.png';
                    break;
                case 'research':
                    title = 'Google Search';
                    favicon = 'https://www.google.com/favicon.ico';
                    break;
            }
            
            document.title = title;
            changeFavicon(favicon);
            
            alert(`Tab cloaking activated! Tab title changed to "${title}"`);
        }

        // Apply custom tab cloaking
        function applyCustomCloak() {
            const customTitle = customTitleInput.value.trim();
            const customFavicon = customFaviconInput.value.trim();
            
            if (!customTitle && !customFavicon) {
                alert('Please enter at least a tab title or favicon URL');
                return;
            }
            
            // Change tab title
            if (customTitle) {
                document.title = customTitle;
            }
            
            // Change favicon
            if (customFavicon) {
                changeFavicon(customFavicon);
            }
            
            alert('Custom tab cloaking applied!');
            
            // Clear inputs
            customTitleInput.value = '';
            customFaviconInput.value = '';
        }

        // Function to change favicon dynamically
        function changeFavicon(url) {
            // Remove existing favicon
            const existingFavicon = document.querySelector('link[rel="icon"]');
            if (existingFavicon) {
                existingFavicon.remove();
            }
            
            // Create new favicon
            const favicon = document.createElement('link');
            favicon.rel = 'icon';
            favicon.type = 'image/x-icon';
            favicon.href = url;
            
            document.head.appendChild(favicon);
        }

        // Embed website
        function embedWebsite() {
            let url = embedUrlInput.value.trim();
            
            if (!url) {
                alert('Please enter a URL');
                return;
            }
            
            // Add protocol if missing
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
            }
            
            // Open in a new tab with about:blank
            const newTab = window.open('about:blank');
            newTab.document.write(`
                <html>
                <head>
                    <title>Embedded Page</title>
                    <style>body, html { margin: 0; padding: 0; height: 100%; } iframe { width: 100%; height: 100%; border: none; }</style>
                </head>
                <body>
                    <iframe src="${url}"></iframe>
                </body>
                </html>
            `);
            
            embedUrlInput.value = '';
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
